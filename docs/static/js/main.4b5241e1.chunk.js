(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,a){e.exports=a(82)},33:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(19),c=a.n(i),l=(a(33),a(3)),o=a(12),s=a(13),u=a.n(s),d=a(25),h=a.n(d),m=a(2),f=function(e,t,a,n){var r=new u.a.LngLat(e.lng,e.lat),i=(new u.a.Popup).setHTML('\n                <div class="MapPopup">\n                    <h1>'.concat(e.road_name,"</h1>\n                    <h2>").concat(e.displayName,'</h2>\n                    <button id="onBtn" class="btn btn-sm">\n                        BeepBoop\n                    </button>\n                </div>\n            ')),c=(new u.a.Marker).setLngLat(r).setPopup(i).addTo(t);c.data=e,e.marker=c,t.markers.push(c),m.l(c.getElement()).select("svg").append("rect").attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").attr("fill","#0000").on("mouseenter",function(){n({type:"setHoveredCP",payload:e.id}),m.l(this.parentNode).transition().duration(200).attr("transform","translate( 0, -8.75 )scale( 1.5 )")}).on("mouseout",function(){n("clearHoveredCP"),m.l(this.parentNode).transition().attr("transform","translate( 0, 0 )scale( 1 )")}),i.on("open",function(e){}),a.extend(r)},p=a(11),v=a(7),_=a(6),g=a(8),y=a(4),E=a(9),b=function(e){var t={};return e.forEach(function(e){var a=t[e.count_point_id]||new w({road_name:e.road_name,id:e.count_point_id,road_type:e.road_type,lat:+e.latitude,lng:+e.longitude,region_id:e.region_id,authority_id:e.local_authority_id,link_length:e.link_length_km,start_junction:e.start_junction_road_name,end_junction:e.end_junction_road_name});t[e.count_point_id]=a;var n={sum_vehicles:+e.all_motor_vehicles+ +e.pedal_cycles,sum_goods:+e.all_hgvs+ +e.lgvs,sum_hgvs:e.all_hgvs,sum_bus_coach:e.buses_and_coaches,sum_cars_taxis:e.cars_and_taxis,sum_lgvs:e.lgvs,sum_hgv_2_rigid:e.hgvs_2_rigid_axle,sum_hgv_3_artic:e.hgvs_3_or_4_articulated_axle,sum_hgv_3_rigid:e.hgvs_3_rigid_axle,sum_hgv_4_rigid:e.hgvs_4_or_more_rigid_axle,sum_hgv_5_artic:e.hgvs_5_articulated_axle,sum_hgv_6_artic:e.hgvs_6_articulated_axle,sum_push:e.pedal_cycles,sum_motorbike:e.two_wheeled_motor_vehicles},r=t[e.count_point_id].counts[e.year]||new M(t[e.count_point_id],e.year,e.estimation_method,e.direction_of_travel);t[e.count_point_id].counts[e.year]=r,r.addDirection(e.direction_of_travel,n)}),t=Object.values(t)},k=function(e,t){return console.log(t),e.filter(function(e){return(!(Object.keys(t).length>0)||Object.entries(t).filter(function(t){return e.hasOwnProperty(t[0])}).every(function(t){var a=Object(l.a)(t,2),n=a[0],r=a[1];return e[n]===r}))&&(!t.distance||O(t.distance.center,[e.lng,e.lat])<1e3*t.distance.radius)})},j=function(e,t){var a=Object.values(e.counts);return t.year&&(a=a.filter(function(e){return e.year===t.year})),a.reduce(function(e,a){return e.addCounts(t.direction||"Total",a.vehicles.getCounts(t.direction))},new S(e)).hierarchy},x=function(e,t){e=e.toString(),t=t.toString();var a=/[^a-zA-Z]/g,n=/[^0-9]/g,r=e.replace(a,""),i=t.replace(a,"");if(r===i){var c=parseInt(e.replace(n,""),10),l=parseInt(t.replace(n,""),10);return c===l?0:c>l?1:-1}return r>i?1:-1},O=function(e,t){var a=function(e){return e*Math.PI/180},n=a(e[1]),r=a(t[1]*Math.PI/180),i=a(t[1]-e[1]),c=a(t[0]-e[0]),l=Math.pow(Math.sin(i/2),2)+Math.cos(n)*Math.cos(r)*Math.pow(Math.sin(c/2),2);return 6371e3*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))};function w(e){var t=e.road_name,a=e.id,n=e.road_type,r=e.lat,i=e.lng,c=e.region_id,l=e.authority_id,o=e.link_length,s=e.start_junction,u=e.end_junction;this.road_name=t,this.id=a.toString(),this.road_type=n,this.lat=r,this.lng=i,this.region_id=c.toString(),this.authority_id=l.toString(),this.link_length=o,this.start_junction=s,this.end_junction=u,this.displayName=s?u+"_"+s:this.id,this.counts={}}var M=function(){function e(t,a,n){Object(y.a)(this,e),this.parent=t,this.year=a.toString(),this.isEstimated="Estimated"===n,this.vehicles=new S(this)}return Object(E.a)(e,[{key:"addDirection",value:function(e,t){return this.vehicles.addCounts(e,t),this}}]),e}(),B=function(){function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(y.a)(this,e),this.name=t,this.values={},this.subcounts=n,this.parent=a}return Object(E.a)(e,[{key:"addValue",value:function(e,t){return this.values[e]=this.values[e]?this.values[e]+t:t,this}},{key:"flatten",value:function(){return Object(o.a)({},this.subcounts,this.children.reduce(function(e,t){return Object(o.a)({},e,t.flatten())},{}))}},{key:"children",get:function(){return Object.values(this.subcounts)}},{key:"total",get:function(){return Object.values(this.values).reduce(function(e,t){return e+t},0)}}]),e}(),S=function(e){function t(e){return Object(y.a)(this,t),Object(v.a)(this,Object(_.a)(t).call(this,"Total Vehicles",e,{sum_goods:new B("Goods",e,{sum_hgvs:new B("HGVs",e,{sum_hgv_6_artic:new B("Six-axle Artic",e),sum_hgv_5_artic:new B("Five-axle Artic",e),sum_hgv_4_rigid:new B("Four-axle Rigid",e),sum_hgv_3_rigid:new B("Three-axle Rigid",e),sum_hgv_3_artic:new B("Three-axle Artic",e),sum_hgv_2_rigid:new B("Two-axle Rigid",e)}),sum_lgvs:new B("LGVs",e)}),sum_push:new B("Pedal Cycles",e),sum_motorbike:new B("Motorbikes",e),sum_bus_coach:new B("Buses and Coaches",e),sum_cars_taxis:new B("Cars and Taxis",e)}))}return Object(g.a)(t,e),Object(E.a)(t,[{key:"getCounts",value:function(e){return Object.entries(this.flatten()).reduce(function(t,a){var n=Object(l.a)(a,2),r=n[0],i=n[1];return Object(o.a)({},t,Object(p.a)({},r,e?i.values[e]||0:i.total))},{sum_vehicles:e?this.values[e]||0:this.total})}},{key:"addCounts",value:function(e,t){return this.addValue(e,t.sum_vehicles),Object.entries(this.flatten()).forEach(function(a){var n=Object(l.a)(a,2),r=n[0],i=n[1];return t[r]&&i.addValue(e,+t[r])}),this}},{key:"hierarchy",get:function(){return m.f(this).each(function(e){return e.value=e.data.total})}}]),t}(B),N=(a(64),function(e){var t=e.children,a=e.id;return r.a.createElement("div",{className:"component-filterHolder",id:a},r.a.createElement("div",null,r.a.createElement("svg",{viewBox:"0 0 100 100"},r.a.createElement("g",{style:{transform:"translate(50%,50%)"}},r.a.createElement("path",{d:"M -7 -10 l -30 -30 h 74 l -30 30 l -5 45 l -6 5 Z"}))),r.a.createElement("h1",null,"Filters")),t)}),C=function(e){var t=e.data,a=e.map,n=e.display,i=e.setDisplay,c=function(e){return t?Array.from(new Set(t.map(function(t){return t[e]}))).sort(x):["NO DATA"]};return r.a.createElement(N,{id:"countPointFilters"},r.a.createElement(D,{title:"Count Point",id:"id",options:c("id"),display:n,setDisplay:i},r.a.createElement("path",{id:"icon_marker",d:"M -25 0 a 30 30 0 1 1 50 0 l -25 40 l -25 -40 M -12.5 -15 a 12.5 12.5 0 0 0 25 0 a 12.5 12.5 0 0 0 -25 0"})),r.a.createElement(L,{display:n,map:a,setDisplay:i},r.a.createElement("path",{id:"icon_marker",d:"M -25 0 a 30 30 0 1 1 50 0 l -25 40 l -25 -40 M -12.5 -15 a 12.5 12.5 0 0 0 25 0 a 12.5 12.5 0 0 0 -25 0",transform:"translate(-15)"}),r.a.createElement("line",{x1:"-15",x2:"25",y1:"40",y2:"10",strokeWidth:"5",strokeDasharray:"6"}),r.a.createElement("use",{href:"#icon_marker",transform:"translate(25,-10)scale(0.6)",opacity:"0.6"})),r.a.createElement(D,{title:"Road Name",id:"road_name",options:c("road_name"),display:n,setDisplay:i},r.a.createElement("line",{x1:"-20",x2:"-20",y1:"35",y2:"15",strokeWidth:"5"}),r.a.createElement("line",{x1:"20",x2:"20",y1:"35",y2:"15",strokeWidth:"5"}),r.a.createElement("rect",{x:"-40",y:"-35",width:"80",height:"50"}),r.a.createElement("text",{x:"0",y:"2"},"A66")),r.a.createElement(D,{title:"Road Type",id:"road_type",options:c("road_type"),display:n,setDisplay:i},r.a.createElement("path",{d:"M -10 -40 h 7 l -1 20 h -8 Z"}),r.a.createElement("path",{d:"M 10 -40 h -7 l 1 20 h 8 Z"}),r.a.createElement("path",{d:"M -13 0 h 9 l -2 40 h -11 Z"}),r.a.createElement("path",{d:"M 13 0 h -9 l 2 40 h 11 Z"}),r.a.createElement("path",{d:"M -40 -15 h 80 v 10 h -7 q -3 0 -3 3 v 7 h -7 l -3 -7 q 0 -3 -3 -3 h -34 q -3 0 -3 3 l -3 7 h -7 v -7 q 0 -3 -3 -3 h -7 v -10"})))},A=function(e){e.data;var t=e.display,a=e.setDisplay;return r.a.createElement(N,{id:"countFilters"},r.a.createElement(D,{title:"Year",id:"year",options:Array.from({length:19},function(e,t){return(2e3+t).toString()}),display:t,setDisplay:a},r.a.createElement("path",{d:"M -30 -30 q -10 0 -10 10 v 50 q 0 10 10 10 h 60 q 10 0 10 -10 v -50 q 0 -10 -10 -10 h -5 a 10 10 0 0 0 -20 0 h -10 a 10 10 0 0 0 -20 0 h -5\n                          M -29 -14 h  13 v  12 h -13 v -12\n                          M -14 -14 h  13 v  12 h -13 v -12\n                          M  1  -14 h  13 v  12 h -13 v -12\n                          M  16 -14 h  13 v  12 h -13 v -12\n                          M -29  2  h  13 v  12 h -13 v -12\n                          M -14  2  h  13 v  12 h -13 v -12\n                          M  1   2  h  13 v  12 h -13 v -12\n                          M  16  2  h  13 v  12 h -13 v -12\n                          M -29  18 h  13 v  12 h -13 v -12\n                          M -14  18 h  13 v  12 h -13 v -12"})),r.a.createElement(D,{title:"Direction",id:"direction",options:["N","S","E","W"],display:t,setDisplay:a},r.a.createElement("path",{d:"M -45 0 a 45 45 0 0 0 90 0 a 45 45 0 0 0 -90 0 M 35 0 a 35 35 0 0 1 -70 0 a 35 35 0 0 1 70 0"}),r.a.createElement("path",{d:"M 0 34 l -10 -32 a 20 20 0 0 0 20 0 l -10 32",transform:"rotate(20)"}),r.a.createElement("path",{d:"M 0 34 l -10 -32 a 20 20 0 0 0 20 0 l -10 32",transform:"rotate(200)"})))},D=function(e){var t=e.children,a=e.title,n=e.id,i=e.options,c=e.display,l=e.setDisplay,o=c.filters.hasOwnProperty(n),s=function(e){l(o?{type:"addFilter",payload:[n,e]}:{type:"removeFilter",payload:n})};return r.a.createElement("div",{className:"component-filterDropdown".concat(o?" active":"")},r.a.createElement("div",{className:"header",onClick:function(){o=!o,s(i[0])}},r.a.createElement("svg",{viewBox:"0 0 100 100"},r.a.createElement("g",{style:{transform:"translate(50%,50%)"}},t))),r.a.createElement("select",{onChange:function(e){return s(e.target.value)},value:c.filters[n]||""},i.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})),r.a.createElement("div",{className:"header_text",onClick:function(){o=!o,s(i[0])}},r.a.createElement("h1",{className:"title"},a),r.a.createElement("h1",{className:"currentFilter"},c.filters[n])))},L=function(e){var t=e.children,a=e.map,i=e.display,c=e.setDisplay,s=i.filters.hasOwnProperty("distance"),d=Object(n.useRef)(null),m=Object(n.useRef)(null),f=function(e,t,a,r,i){var c=Object(n.useState)(null),s=Object(l.a)(c,2),d=s[0],m=s[1];return Object(n.useEffect)(function(){if(t&&e){var n=new h.a({accessToken:a,mapboxgl:u.a,clearAndBlurOnEsc:!1});t.current.appendChild(n.onAdd(e)),m(n),n.on("result",function(e){return r({type:"addFilter",payload:["distance",Object(o.a)({},e.result,{radius:i.current.value})]})}),n.on("clear",function(e){return r({type:"removeFilter",payload:"distance"})})}},[e,t,i,a]),d}(a,d,"pk.eyJ1IjoianJpZGxleTI0NiIsImEiOiJjanhpMzYxdXcxbWliNDFsN2g2bGg3ODg2In0.qqSDB24vCq0mdKUCdY4zgw",c,m),p=function(e){s?c({type:"addFilter",payload:["distance",i.filters.distance?Object(o.a)({},i.filters.distance,{radius:e}):null]}):f.clear()};return r.a.createElement("div",{className:"component-geoCoder".concat(s?" active":"")},r.a.createElement("div",{className:"header",onClick:function(){s=!s,p(5)}},r.a.createElement("svg",{viewBox:"0 0 100 100"},r.a.createElement("g",{style:{transform:"translate(50%,50%)"}},t))),r.a.createElement("div",{className:"geoCoder",ref:d},r.a.createElement("select",{ref:m,onChange:function(e){return p(e.target.value)},value:i.filters.distance?i.filters.distance.radius:"5"},r.a.createElement("option",{value:"5"},"<5km"),r.a.createElement("option",{value:"10"},"<10km"),r.a.createElement("option",{value:"15"},"<15km"))),r.a.createElement("div",{className:"header_text",onClick:function(){s=!s,p(5)}},r.a.createElement("h1",{className:"title"},"Distance"),r.a.createElement("h1",{className:"currentFilter"},i.filters.distance?i.filters.distance.text:"")))},q=(a(65),function(e){e.children;var t=e.data,a=e.filteredData,i=e.display,c=e.setDisplay,o=Object(n.useState)(null),s=Object(l.a)(o,2),d=s[0],h=s[1],m=Object(n.useRef)(null),p=function(e){var t=e.accessToken,a=e.mapRef,r=Object(n.useState)(null),i=Object(l.a)(r,2),c=i[0],o=i[1];return Object(n.useEffect)(function(){if(a.current){u.a.accessToken=t;var e=new u.a.Map({container:a.current,style:"mapbox://styles/jridley246/cjxi67z0i42vy1cldfj812u8x"});o(e),e.addControl(new u.a.NavigationControl,"bottom-left"),e.markers=[]}},[t,a]),c}({accessToken:"pk.eyJ1IjoianJpZGxleTI0NiIsImEiOiJjanhpMzYxdXcxbWliNDFsN2g2bGg3ODg2In0.qqSDB24vCq0mdKUCdY4zgw",mapRef:m});return function(e,t,a,r){Object(n.useEffect)(function(){if(e&&t){var a=new u.a.LngLatBounds;e.markers.filter(function(e){return!t.includes(e.data)}).forEach(function(e){e.data.marker=null,e.remove()}),e.markers=e.markers.filter(function(e){return t.includes(e.data)}),t.forEach(function(t){return!t.marker&&f(t,e,a,r)}),a._ne&&e.fitBounds(a,{padding:{left:50,top:50,bottom:50,right:400},duration:1e3})}},[e,t,r])}(p,d,0,c),Object(n.useEffect)(function(){a&&h(a)},[a,i.filters]),r.a.createElement("div",{className:"Mapbox",ref:m},r.a.createElement(C,{data:t,map:p,display:i,setDisplay:c}))}),P=function(e,t){var a=function(t){return Object(o.a)({},e,t)},n=t instanceof Object?t:{type:t},r=n.type,i=n.payload;switch(r){case"setMulti":return a(i);case"addFilter":return a({filters:Object(o.a)({},e.filters,Object(p.a)({},i[0],i[1]))});case"setFilter":return a({filters:i});case"setView":return a({view:i});case"removeFilter":return delete e.filters[i],a({filters:Object(o.a)({},e.filters)});case"clearFilters":return a({filters:{}});case"setHoveredCP":return a({hoveredCP:i});case"clearHoveredCP":return a({hoveredCP:null});default:throw new Error("Display state: Action not recognised")}},F=a(10);a(66);function I(e){var t=e.children,a=e.data,i=e.display,c=e.setDisplay,o=Object(n.useRef)(null),s=Object(n.useState)(!1),u=Object(l.a)(s,2),d=u[0],h=u[1],f=Object(n.useMemo)(function(){return{top:10,left:100,height:370,width:590}},[]);return Object(n.useEffect)(function(){if(a){var e=m.l(o.current);h(a.length>25),a.length>25?e.selectAll(".StackedBar_Bars > g").remove():T(e,f,i.view,c,a.reduce(function(e,t){var a=j(t,i.filters).descendants().find(function(e){return e.data.name===i.view[1]});return e.barLabels.push(t.id),e.graphData.push(a),e.lastIndex=void 0===e.lastIndex?a.parent?a.parent.children.indexOf(a):0:e.lastIndex,e.route=void 0===e.route||i.view[0],e},{barLabels:[],graphData:[],lastIndex:void 0}))}},[a,i.filters,i.view,f,c]),Object(n.useEffect)(function(){i.hoveredCP?m.m('.StackedBar_Bars > g > rect:not([class="'.concat(i.hoveredCP,'"])')).transition("fade").duration(100).attr("opacity",.2):m.m(".StackedBar_Bars > g > rect").transition("fade").duration(50).attr("opacity",1)},[i.hoveredCP]),r.a.createElement("div",{className:"HierarchicalGraph"},r.a.createElement("div",{className:"HierarchicalGraph_overloadWarning".concat(d?" overload":"")},r.a.createElement("p",null,"Phew, that's a lot of data...",a?a.length:0," count points to be exact!",r.a.createElement("br",null),"Try applying more filters")),t,r.a.createElement("svg",{className:"StackedBar",viewBox:"0 0 900 500",preserveAspectRatio:"xMidYMid",ref:o},r.a.createElement("rect",{className:"StackedBar_BG",x:"0",y:"0",width:"100%",height:"100%",fill:"#0000"}),r.a.createElement("text",{className:"StackedBar_Title"}),r.a.createElement("g",{className:"StackedBar_Legend",transform:"translate( ".concat(f.left+f.width+50,", 100 )")}),r.a.createElement("g",{className:"StackedBar_Axes"},r.a.createElement("g",{className:"StackedBar_Axes--Left",transform:"translate( ".concat(f.left,", 0 )")}),r.a.createElement("g",{className:"StackedBar_Axes--Bottom",transform:"translate( 0, ".concat(f.height+f.top," )")})),r.a.createElement("g",{className:"StackedBar_Bars"})))}var T=function(e,t,a,n,r){var i=Object(l.a)(a,2),c=i[0],o=i[1],s=r.barLabels,u=r.graphData,d=r.lastIndex,h=function(e){m.e.preventDefault(),u[0].parent&&n({type:"setView",payload:["ascent",u[0].parent.data.name]})};e.select(".StackedBar_BG").on("contextmenu click",h);var f=m.o().duration(500),p=function(e){e.transition("fade").duration(50).attr("opacity",1)},v=function(e){e.transition("fade").duration(100).attr("opacity",.2)},_=G(u),g=_.stackedData,y=_.subgroups,E=_.colour,b=Math.max.apply(Math,Object(F.a)(u.map(function(e){return e.value}))),k=m.h().domain(s).range([t.left,t.width+t.left]).padding([.2]),j=m.i().domain([0,1.1*b]).range([t.height+t.top,t.top]),x=[];e.select(".StackedBar_Bars").selectAll("g").data(g,function(e){return e.key}).join(function(e){return e.append("g").attr("class",function(e){return e.key}).attr("fill",function(e){return E(e.key)})},function(e){return e},function(e){"descent"===c&&e.filter(function(e,t){return t===d}).selectAll("rect").each(function(){x.push([+m.l(this).attr("y"),+m.l(this).attr("height")])}),e.remove()}).on("mousemove",function(e){var t=this;m.m(".StackedBar_Bars > g").filter(function(){return this!==t}).call(v),m.m('.StackedBar_Legend > g:not([id="'.concat(e.key,'"])')).call(v)}).on("mouseout",function(){var e=this;m.m(".StackedBar_Bars > g, .StackedBar_Legend > g").filter(function(){return this!==e}).call(p)}).on("click",function(e){e[0].data.children&&n({type:"setView",payload:["descent",e.key]})}).on("contextmenu",h).selectAll("rect").data(function(e){return e}).join(function(e){return e=e.append("rect"),"descent"===c?e.each(function(e,t){var a=Math.max.apply(Math,Object(F.a)(g.map(function(e){return e[t][1]}))),n=m.i().domain([0,a]).range([x[t][0]+x[t][1],x[t][0]]);m.l(this).attr("y",n(e[1])).attr("height",n(e[0])-n(e[1]))}):e.attr("y",function(e){return j(e[1])}).attr("height",0),e}).attr("class",function(e,t){return e.data.data.parent.id}).attr("x",function(e,t){return k(s[t])}).attr("width",k.bandwidth()).transition(f).attr("y",function(e){return j(e[1])}).attr("height",function(e){return j(e[0])-j(e[1])}),R(e,{title:o,seriesLabels:y.map(function(e,t){return{label:e,colour:E(e)}}).reverse()}),Z(e,k,j)},R=function(e,t){t.title;var a=t.seriesLabels,n=function(e){e.attr("x",100).attr("opacity",0).transition("fade").duration(200).attr("x",0).attr("opacity",1)},r=function(e,t){m.l('[class="'.concat(e.label,'"]')).each(function(e,a){m.l(this).on(t).apply(this,[e,a])})},i=function(e){return r(e,"mousemove")},c=function(e){return r(e,"mouseout")},l=function(e){return r(e,"click")},o=function(e){return r(e,"contextmenu")};e.select(".StackedBar_Legend").selectAll("g").data(a,function(e){return e.label}).join(function(e){var t=e.append("g").attr("class","legend_entry").attr("id",function(e){return e.label}).attr("transform",function(e,t){return"translate( 0, ".concat(25*t," )")}).on("mousemove",i).on("mouseout",c).on("click",l).on("contextmenu",o);t.append("circle").attr("cx","-12").attr("cy",-6).attr("r",10).attr("fill",function(e){return e.colour}).call(n),t.append("text").text(function(e){return e.label}).attr("fill",function(e){return e.colour}).call(n)},function(e){},function(e){e.remove()})},Z=function(e,t,a){var n=e.select(".StackedBar_Axes");n.select(".StackedBar_Axes--Left").transition().call(m.b(a).tickSize(-600)),n.select(".StackedBar_Axes--Bottom").transition().call(m.a(t).tickPadding([0]).tickSizeOuter([0])).selectAll("text").attr("y",0).attr("dx",-9),n.select(".StackedBar_Axes--Bottom").selectAll(".tick > text").attr("transform","rotate(-45)")},G=function(e,t){var a,n,r;return 0===e.length?{stackedData:[],subgroups:[],colour:function(){}}:(e[0].children?(a=e[0].children.map(function(e){return e.data.name}),n=m.n().keys(a).value(function(e,t){return e.children.find(function(e){return e.data.name===t}).value})):(a=[e[0].data.name],n=m.n().keys(a).value(function(e,t){return e.value})),r=m.j().domain(a).range(m.k),{stackedData:n(e),subgroups:a,colour:r})},H=a(27),V=a(26),W=a(15),z=(a(67),function(e){var t=e.children;return r.a.createElement("div",{className:"App_sidebar"},t)}),J=function(e){var t=e.children,a=(e.vspan,e.hspan,Object(n.useState)(!1)),i=Object(l.a)(a,2),c=i[0],o=i[1],s=Object(W.c)(function(){return{left:0,top:0,position:"absolute",config:W.b.stiff}}),u=Object(l.a)(s,2),d=u[0],h=u[1],m=Object(n.useRef)(null);return r.a.createElement("div",{className:"App_sidebar_frame"},r.a.createElement("div",{id:"layoutPlaceholder",style:{width:"100%",height:"100%"}}),r.a.createElement(W.a.div,{ref:m,className:"App_frame_children".concat(c?" fullscreen":""),style:d},t),r.a.createElement(Y,{maximised:c,setMaximised:function(e){o(e);var t=m.current.parentNode.getBoundingClientRect(),a=t.left,n=t.top;console.log(e),h({from:{left:e?a:0,top:e?n:0,position:"fixed"},to:{left:e?0:a,top:e?0:n},onRest:function(){return d.position.value=e?"fixed":"absolute"}})}}))},Y=function(e){var t=e.maximised,a=e.setMaximised,i=Object(n.useState)(0),c=Object(l.a)(i,2),o=c[0],s=c[1],u=Object(n.useRef)(null),d=Object(V.a)({onHover:function(e){var t=e.hovering;s(t?1:0)},onDragStart:function(){return a(!t)}}),h=Object(n.useCallback)(m.g("\n            M -10 0\n            L 0 0\n            L 0 10\n            M 0 10\n            L 0 0\n            L 10 0\n            M 10 0\n            L 0 0\n            L 0 -10\n            M 0 -10\n            L 0 0\n            L -10 0\n            ","\n            M -10 2\n            L -10 10\n            L -2 10\n            M 2 10\n            L 10 10\n            L 10 2\n            M 10 -2\n            L 10 -10\n            L 2 -10\n            M -2 -10\n            L -10 -10\n            L -10 -2\n        "),[]);return r.a.createElement("div",{className:"Maximise_Button"},r.a.createElement("svg",{viewBox:"0 0 30 30"},r.a.createElement("rect",Object.assign({x:"0",y:"0",width:"100%",height:"100%"},d())),r.a.createElement(H.Spring,{from:{t:0===o?1:0},to:{t:o},config:{tension:360,friction:24}},function(e){var t=e.t;return r.a.createElement(W.a.path,{ref:u,d:h(t),transform:"translate(15,15)"})})))},K=(a(80),function(e){var t=e.loading,a=Object(W.c)({from:{opacity:t?0:1},opacity:t?1:0,delay:1e3}),i=Object(n.useRef)(null);return Object(n.useEffect)(function(){if(i.current){var e=m.l(i.current);!function t(){0!==a.opacity.value&&e.selectAll("#load_car_wheel").attr("transform","rotate(0)").transition().duration(500).ease(m.d).attr("transform","rotate(180)").on("end",t)}(),function t(){0!==a.opacity.value&&e.selectAll("#load_car").attr("transform","translate( 160, 195 )").transition().attr("transform","translate( 160, 193 )").on("end",t)}(),function t(){0!==a.opacity.value&&(e.selectAll("#load_car").transition("smokeLoop").duration(200).on("end",t),e.selectAll("#load_car").append("circle").attr("id","load_car_smoke").attr("cx",10).attr("cy",0).attr("r",5).attr("opacity",1).transition().duration(1e3).attr("cx",-50*Math.random()-50).attr("cy",-30*Math.random()-30).attr("r",50).attr("opacity",0).remove())}(),e.selectAll("#load_bush > g").each(function e(){var t=this;0!==a.opacity.value&&m.l(this).attr("transform","translate(700, 210)").transition().ease(m.d).duration(4e3*Math.random()+2e3).attr("transform","translate(-100, 210)").on("end",function(){return e.bind(t)()})})}}),r.a.createElement(W.a.div,{className:"loadScreen",style:a},r.a.createElement("svg",{viewBox:"0 0 600 214",ref:i},r.a.createElement("g",{id:"load_road"},r.a.createElement("rect",{x:"0",y:"210",width:"100%",height:"2%"}),r.a.createElement("g",{id:"load_bush"},r.a.createElement("g",{id:"load_bush--1",transform:"translate(50,210)"},r.a.createElement("path",{d:"M 0 0 a 30 30 0 0 1 0 -50 a 30 30 0 0 1 45 -10 v 60 Z",fill:"#4CA134"}),r.a.createElement("path",{d:"M 44 -60 a 30 30 0 0 1 30 15 a 30 30 0 0 1 10 45 h -40 Z",fill:"#77BC1F"})),r.a.createElement("g",{id:"load_bush--2",transform:"translate(400,210)"},r.a.createElement("path",{d:"M 0 0 a 40 40 0 0 1 20 -50 a 40 40 0 0 1 40 -30 v 80 Z",fill:"#7C8F29"}),r.a.createElement("path",{d:"M 59 -80 a 40 40 0 0 1 30 50 a 40 40 0 0 1 10 30 h -39 Z",fill:"#9BB53F"}))),r.a.createElement("g",{id:"load_cloud"},r.a.createElement("line",{id:"load_cloud--1",x1:"200",x2:"400",y1:"30",y2:"30"}),r.a.createElement("line",{id:"load_cloud--2",x1:"240",x2:"500",y1:"40",y2:"40"}))),r.a.createElement("g",{id:"load_car_wheels",transform:"translate(223,193)"},r.a.createElement("g",{id:"load_car_wheel"},r.a.createElement("circle",{r:"18",id:"load_car_wheel_outer"}),r.a.createElement("circle",{r:"10",id:"load_car_wheel_inner"}),r.a.createElement("path",{d:"M -10 0 h 20 M 0 -10 v 20"}),r.a.createElement("path",{d:"M -8 0 h 16 M 0 -8 v 16",transform:"rotate(45)"})),r.a.createElement("use",{href:"#load_car_wheel",transform:"translate(144,0)"})),r.a.createElement("g",{id:"load_car"},r.a.createElement("path",{d:"M10-10\n                            q 5 -10 0 -27\n                            l 42 -3\n                            q 7 -1 5 -5 l -3 -17\n                            q 55 -10 105 -5\n                            q 3 0 17 25\n                            l 63 5\n                            q 5 5 0 20\n                            q 8 5 2 16\n                            h -13\n                            a 22 22 0 1 0 -42 10\n                            h -105\n                            a 20 20 0 1 0 -38 -6\n                            q -15 0 -20 -4\n                            Z"}),r.a.createElement("g",{id:"load_car_windows"},r.a.createElement("path",{d:"M 67 -52 q -3 -4 4 -6 q 20 -3 30 -4 q 6 0 5 8 v 8 q 0 6 -5 6 h -20 q -5 0 -12 -10 Z"}),r.a.createElement("path",{d:"M 120 -62.5 l 28 0 v 22 h -33 q -2 0 -4 -5 v -13 q 0 -4 5 -4 Z"}),r.a.createElement("path",{d:"M 148 -62.5 q 4 0 6 4 l 8 11 q 5 6 -1 7 h -13"})),r.a.createElement("path",{d:"M 13 -19 q 20 -3 100 -5 q 100 -1 118 -2 l 8 -10",fill:"none",stroke:"silver"}))),r.a.createElement("h1",null,"Loading data..."))});a(81);var U=function(e){var t=e.data;return Object(n.useEffect)(function(){},[t]),r.a.createElement("div",{className:"StreamGraph"},"Graph of CP data by year, following the focused data from stacked bars")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],i=t[1],c=Object(n.useState)(!1),o=Object(l.a)(c,2),s=o[0],u=o[1],d=Object(n.useReducer)(P,{filters:{},sort:["",""],hoveredCP:null}),h=Object(l.a)(d,2),f=h[0],p=h[1];Object(n.useEffect)(function(){u(!0),m.c("./devon.csv").then(function(e){var t=b(e);p({type:"setMulti",payload:{filters:{},sort:["date","Ascending"],view:["","Total Vehicles"],hoveredCP:null,focusedCP:null}}),i(t),u(!1)})},[]);var v=Object(n.useMemo)(function(){return a&&k(a,f.filters)},[a,f.filters]),_=Object(n.useCallback)(r.a.createElement(A,{data:a,display:f,setDisplay:p}),[a,f.filters]),g=Object(n.useCallback)(r.a.createElement(q,{data:a,filteredData:v,display:f,setDisplay:p}),[v,a]),y=Object(n.useCallback)(r.a.createElement(K,{loading:s}),[s]);return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App_header"},r.a.createElement("h1",null,"Devon Annual Average Daily Flows (AADFs)")),r.a.createElement("div",{className:"page"},y,g,r.a.createElement(z,null,r.a.createElement(J,null,r.a.createElement(I,{data:v,display:f,setDisplay:p},_)),r.a.createElement(J,null,r.a.createElement(U,{data:v})))))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[28,1,2]]]);
//# sourceMappingURL=main.4b5241e1.chunk.js.map